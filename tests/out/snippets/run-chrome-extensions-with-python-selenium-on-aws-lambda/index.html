<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=yes" />
    <meta name="generator" content="Pelican 4.7.1" />
<meta name="author" content="Rehan Haider">
<meta name="keywords" content="aws, lambda, selenium, python, chrome, chromedriver">
    <meta name="description" content=" A detailed guide to use Selenium and Chrome with extensions on AWS Lambda ">
    <link rel="canonical" href="http://localhost:8080/snippets/run-chrome-extensions-with-python-selenium-on-aws-lambda">

    <!-- Prefetches -->
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="prefetch" as="script" href="/assets/js/app.js" />

    <!-- Title -->
    <title> Run Chrome extensions with Python Selenium on AWS Lambda </title>
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/assets/img/icons/favicon.svg">
    <link rel="icon" type="image/png" href="/assets/img/icons/favicon.png">
    <!-- App icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="manifest" href="/assets/site.webmanifest">
    <meta name="msapplication-TileColor" content="#fdf6e3">
    <meta name="msapplication-config" content="/assets/browserconfig.xml">
    <meta name="theme-color" content="#fff">

    <!-- Social -->
    <meta property="og:title" content="Run Chrome extensions with Python Selenium on AWS Lambda" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="<jinja2.runtime.BlockReference object at 0x7fdf7736a920>" />
    <meta property="og:image" content="/assets/img/banner.png" />
    <meta property="og:description" content="A detailed guide to use Selenium and Chrome with extensions on AWS Lambda" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@cloudbytes_dev" />
    <meta name="twitter:title" content="Run Chrome extensions with Python Selenium on AWS Lambda" />
    <meta name="twitter:description" content="A detailed guide to use Selenium and Chrome with extensions on AWS Lambda" />
    <meta name="twitter:image" content="/assets/img/banner.png" />


    <!-- Theme -->
    <link rel="stylesheet" href="/assets/css/style.css">

    <!-- App -->
    <script defer src="/assets/js/app.js"></script>
    <!-- Ad
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0503340532690886"
        crossorigin="anonymous"></script>
         -->
</head>

<body>
    <!--Top nav-->
    <nav class="topnav">
<div style="visibility: visible;">
    <div id="search-open" class="item mega-dropdown" style="border-radius: 15px 0 0 15px;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128">
            <path fill="currentColor"
                d="M120.5891,106.37506,96.5609,80.39355l-3.842,3.8457-4.35187-4.35187c.33368-.43195.667-.864.98346-1.30475A46.77661,46.77661,0,1,0,77.87956,89.85687q.99472-.68619,1.955-1.42987l4.34509,4.345-4.31427,4.31409,26.5097,23.5246a10.0585,10.0585,0,1,0,14.21405-14.23566ZM74.21977,74.22931a32.4793,32.4793,0,1,1,9.48859-22.94189A32.48241,32.48241,0,0,1,74.21977,74.22931Z" />
        </svg>
    </div>
</div>

<div class="item" style="border-radius: 0;">
    <a href="https://github.com/CloudBytesDotDev/CloudBytes.dev/discussions" target="_blank" rel="noopener"
        aria-label="GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path fill="currentColor"
                d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
        </svg>
    </a>
</div>

<div id="themeButton">
    <div id="dark" class="item">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <g class="fa-group">
                <path fill="currentColor"
                    d="M320 32L304 0l-16 32-32 16 32 16 16 32 16-32 32-16zm138.7 149.3L432 128l-26.7 53.3L352 208l53.3 26.7L432 288l26.7-53.3L512 208z"
                    class="fa-secondary"></path>
                <path fill="currentColor"
                    d="M332.2 426.4c8.1-1.6 13.9 8 8.6 14.5a191.18 191.18 0 0 1-149 71.1C85.8 512 0 426 0 320c0-120 108.7-210.6 227-188.8 8.2 1.6 10.1 12.6 2.8 16.7a150.3 150.3 0 0 0-76.1 130.8c0 94 85.4 165.4 178.5 147.7z"
                    class="fa-primary"></path>
            </g>
        </svg>
    </div>
    <div id="light" class="item">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <g class="fa-group">
                <path fill="currentColor"
                    d="M502.42 240.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.41-94.8a17.31 17.31 0 0 0-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4a17.31 17.31 0 0 0 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.41-33.5 47.3 94.7a17.31 17.31 0 0 0 31 0l47.31-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3a17.33 17.33 0 0 0 .2-31.1zm-155.9 106c-49.91 49.9-131.11 49.9-181 0a128.13 128.13 0 0 1 0-181c49.9-49.9 131.1-49.9 181 0a128.13 128.13 0 0 1 0 181z"
                    class="fa-secondary"></path>
                <path fill="currentColor" d="M352 256a96 96 0 1 1-96-96 96.15 96.15 0 0 1 96 96z" class="fa-primary">
                </path>
            </g>
        </svg>
    </div>
</div>
<menu-toggler style="visibility: visible;">
    <div id="open" class="item  mega-dropdown" style="border-radius: 0 15px 15px 0;">
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32"
            style="enable-background:new 0 0 32 32;" xml:space="preserve">
            <g>
                <path fill="currentColor" d="M16,10c1.7,0,3-1.3,3-3s-1.3-3-3-3s-3,1.3-3,3S14.3,10,16,10z" />
                <path fill="currentColor" d="M16,13c-1.7,0-3,1.3-3,3s1.3,3,3,3s3-1.3,3-3S17.7,13,16,13z" />
                <path fill="currentColor" d="M16,22c-1.7,0-3,1.3-3,3s1.3,3,3,3s3-1.3,3-3S17.7,22,16,22z" />
            </g>
        </svg>
    </div>
    <div id="close" class="item mega-dropdowns" style="border-radius: 0 15px 15px 0; display: none;">
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 72.434 72.44"
            style="enable-background:new 0 0 72.434 72.44;" xml:space="preserve">
            <path style="fill:currentColor;" d="M36.22,0C16.212,0,0,16.216,0,36.227c0,19.999,16.212,36.214,36.22,36.214
       c20.011,0,36.214-16.215,36.214-36.214C72.434,16.215,56.231,0,36.22,0z M52.058,46.82c1.379,1.424,0.953,4.078-0.959,5.932
       c-1.911,1.854-4.577,2.209-5.959,0.785l-9.027-9.295l-9.298,9.027c-1.421,1.379-4.075,0.947-5.929-0.961s-2.206-4.574-0.785-5.956
       l9.298-9.027l-9.027-9.298c-1.379-1.421-0.946-4.078,0.962-5.932c1.905-1.851,4.577-2.204,5.953-0.785l9.027,9.297l9.301-9.023
       c1.424-1.382,4.078-0.95,5.929,0.958c1.857,1.908,2.206,4.577,0.785,5.959l-9.295,9.024L52.058,46.82z" />
        </svg>
    </div>
</menu-toggler>

<div id="mega" class="mega-menu" style="visibility: hidden;">
    <div class="mega-main">
        <section>
            <h3>Content</h3>
            <ul>
                <li><a href="/snippets">Quick Snippets</a></li>
                <li><a href="/books">Books</a></li>
                <li><a href="/tags">#tags</a></li>
            </ul>
        </section>
        <section>
            <h3>Tags</h3>
            <ul>
                <li><a href="/tags/python">#python</a></li>
                <li><a href="/tags/aws">#aws</a></li>
                <li><a href="/tags/firebase">#firebase</a></li>
                <li><a href="/tags/python">#pelican</a></li>
            </ul>
        </section>
        <section>
            <h3>CloudBytes@</h3>
            <ul>
                <li><a href="http://github.com/CloudBytesDotDev">Github</a></li>
            </ul>
        </section>
    </div>
    <div class="row mega-footer">
        <span>CloudBytes</span> <a href="/terms">Terms</a> <a href="/privacy">Privacy</a>
    </div>
</div>
<div id="search" class="modal-overlay modal-show" style="visibility: hidden;">
    <div class="algolia-hits">
        <div class="algolia-form-wrap">
            <input placeholder="Search for bytes ..." type="text" id="algolia-input" class="algolia-input"
                autocomplete="off" />
            <span id="search-close" class="algolia-close btn btn-red">X</span>
        </div>
    </div>
</div><!--End Topnav-->
    </nav>
    <!--Top nav-->
    <script>
        // Theme toggler
        const themeNext = {
            dark: "light",
            light: "dark"
        };
        var theme = "dark";
        if (localStorage.getItem('theme')) {
            theme = localStorage.getItem('theme');
        }
        document.body.classList.remove('dark-theme', 'light-theme');
        document.body.classList.add(theme + '-theme');
        document.getElementById(themeNext[theme]).style.display = "flex";
        document.getElementById(theme).style.display = "none";
        // Theme button events
        var switchTheme = document.getElementById('themeButton');
        var toggleLight = document.getElementById('light');
        var toggleDark = document.getElementById('dark');
        switchTheme.addEventListener('click', function (e) {
            e.preventDefault();
        });
        toggleLight.addEventListener('click', function (e) {
            e.preventDefault();
            document.body.classList.add('light-theme');
            document.body.classList.remove('dark-theme');
            localStorage.setItem('theme', 'light');
            toggleLight.style.display = "none";
            toggleDark.style.display = "flex";
        });
        toggleDark.addEventListener('click', function (e) {
            e.preventDefault();
            document.body.classList.add('dark-theme');
            document.body.classList.remove('light-theme');
            localStorage.setItem('theme', 'dark');
            toggleLight.style.display = "flex";
            toggleDark.style.display = "none";
        });
    </script>
    <!-- Navbar -->
    <nav class="navbar">
<a href="/" id="home" class="item logo" style="opacity: 1;">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" class="svg-inline--fa fa-home fa-w-18"
        role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
        <path fill="currentColor"
            d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z">
        </path>
    </svg>
    <span class="item-label tag tag-contrast tag-sm">Home</span>
</a>
<a href="/snippets" id="snippets" class="item">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="code" class="svg-inline--fa fa-code fa-w-20"
        role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
        <path fill="currentColor"
            d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z">
        </path>
    </svg>
    <span class="item-label tag tag-contrast tag-sm">How-to Articles</span>
</a>
<a href="/books" id="books" class="item">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="book" class="svg-inline--fa fa-book fa-w-14"
        role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
            d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z">
        </path>
    </svg>
    <span class="item-label tag tag-contrast tag-sm">Publications</span>
</a>
<a href="/tags" id="tags" class="item">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags fa-w-20"
        role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
        <path fill="currentColor"
            d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z">
        </path>
    </svg>
    <span class="item-label tag tag-contrast tag-sm">Tags</span>
</a>    </nav>
    <!-- End Navbar -->

    <!-- Main Section -->
    <main>
<article class="content-pad">
    <div class="content-main">
        <section class="content-article">
<h1 id="title" class="article-title">Run Chrome extensions with Python Selenium on AWS Lambda</h1>
<div class="article-byline">
    <em>by <a href="/authors/rehan-haider">Rehan Haider</a>, Sat 25 December 2021</em>
    <span>
        <strong>Category</strong>:
        <a href="/snippets" class="tag tag-snippets">
            Snippets
        </a>
    </span>
</div>            <article id="content">
                <div class="admonition warning">
<p class="admonition-title">UPDATE 29 March 2022: <strong>As of this update, the instructions in this article may not work on AWS Lambda. Please refer to <a href="https://github.com/CloudBytesDotDev/CloudBytes.dev/discussions/103">this discussion on GitHub</a> for more details and alternative options.</strong></p>
</div>
<p>I earlier wrote about how to <a href="http://localhost:8080/snippets/run-selenium-in-aws-lambda-for-ui-testing">run Chrome AWS Lambda using Python and Selenium webdriver</a>, but running Chrome with extensions is a different ball game. So let's unpack the problem first, and then we'll get to the solution. </p>
<p>Chrome, when started in headless mode will start without browser UI, it is just a webpage viewport sans anything else. </p>
<p><img alt="chrome-comparison" src="http://localhost:8080/images/99999962-chrome-comparison.png"></p>
<blockquote>
<p>You can take a screenshot by running the command <code>google-chrome --headless --disable-gpu --screenshot https://cloudbytes.dev</code></p>
</blockquote>
<h2 id="why-your-chrome-extensions-are-not-working-using-selenium-in-headless-mode">Why your Chrome extensions are not working using Selenium in headless mode?</h2>
<p>As demonstrated above, because your Chrome is running in headless mode, it will not have any UI and thus no extensions are loaded. This is not a bug, it is a feature as explained here on <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=706008">chromium website</a>.</p>
<p>So to be able to load extensions, you need to run Chrome in non-headless mode. Which is problematic considering AWS Lambda doesn't have a display so you cannot really run Chrome GUI. </p>
<p><strong>Or can you?</strong>\
Yes you can, of course you can, I'll show you how.</p>
<h2 id="how-to-run-chrome-with-extensions-in-aws-lambda">How to run Chrome with extensions in AWS Lambda</h2>
<p>For this example, a reader asked to try to run <a href="https://chrome.google.com/webstore/detail/gofullpage-full-page-scre/fdpohaocaechififmbbbbbknoalclacl?hl=en">GoFullPage</a> extension in AWS Lambda. This extension relies on user-interaction thus presents a complex problem.</p>
<p>Let's try and break this problem down.</p>
<ol>
<li>Extensions do not work in Chrome headless mode, thus you need to run Chrome in non-headless mode, i.e. with a display</li>
<li>AWS Lambda doesn't have a display, so you need a virtual display to run Chrome GUI. We will use <code>Xvfb</code> with <code>pyvirtualdisplay</code> wrapper to do this</li>
<li>The extension relies on user-interaction, but, Selenium cannot be used for these interactions since it restricts user interaction to DOM elements and doesn't allow sending hotkeys to browser. Thus we will need to create a virtual keyboard to send keys to browser. In this case I chose to use <code>pyautogui</code></li>
<li>PyAutoGUI is a Python wrapper around the <code>Xlib</code> library and relies on several linux packages that are NOT AVAILABLE on AWS Lambda's default image that uses Amazon Linux 2 (derivative of CentOS) . So we need to use Debian based image on AWS Lambda to run this example. I chose to use Python Buster image.</li>
</ol>
<p>Now with that out of the way, let's get started.</p>
<h2 id="setting-up-the-development-environment">Setting up the development environment</h2>
<p><strong>Step 1</strong>: You need <a href="https://code.visualstudio.com/download">VSCode</a>, <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>, and WSL2 as the development environment. You can find instructions on how to setup WSL2 <a href="http://localhost:8080/snippets/how-to-install-wsl2-on-windows-1011">here</a></p>
<p><strong>Step 2</strong>: Start the VScode editor</p>
<ol>
<li>Start the terminal and login to WSL2 by running <code>wsl</code></li>
<li>Make a new directory <code>mkdir selenium-aws</code> and cd into it <code>cd selenium-aws</code></li>
<li>Launch the VS Code editor by running <code>code .</code></li>
</ol>
<p><img alt="start-vscode-wsl2" src="http://localhost:8080/images/99999962-start-vscode-wsl2.gif"></p>
<p><strong>Step 3</strong>: Reopen the folder in a devcontainer</p>
<ol>
<li>While in VScode, press <code>Ctrl + Shift + P</code> to open command palette</li>
<li>Choose <code>Reopen in Container</code> from the drop down menu</li>
<li>Then click on <code>Show All Definitions</code></li>
<li>Choose <code>Docker in Docker</code> from the drop down menu (Do not select <code>Docker from Docker</code>)</li>
<li>Leave the default selections and choose OK in the next two dialogues</li>
</ol>
<p><img alt="create-devcontainer" src="http://localhost:8080/images/99999962-create-devcontainer.gif"></p>
<p>Next, install the following:</p>
<p><strong>Step 4</strong>: <a href="http://localhost:8080/snippets/build-deploy-serverless-apps-on-aws-with-sam-cli#install-aws-cli">Install AWS CLI</a></p>
<p><strong>Step 5</strong>: <a href="http://localhost:8080/snippets/build-deploy-serverless-apps-on-aws-with-sam-cli#install-aws-sam-cli">Install SAM CLI</a></p>
<p>And finally, configure AWS CLI as per below</p>
<p><strong>Step 6</strong>: <a href="http://localhost:8080/snippets/build-deploy-serverless-apps-on-aws-with-sam-cli#configuring-aws-aws-cli">Configure AWS &amp; AWS CLI</a></p>
<h2 id="running-chrome-extensions-using-selenium-in-aws-lambda">Running Chrome Extensions using Selenium in AWS Lambda</h2>
<p>Unlike a <a href="http://localhost:8080/snippets/run-aws-lambda-using-custom-docker-container#create-a-new-app">previous guide</a> we'll use a manual SAM templates to create a new Lambda app. </p>
<p>Your folder structure should look like below</p>
<div class="highlight"><pre><span></span><code>.
├── __init__.py
├── events
│   └── event.json
├── src
│   ├── __init__.py
│   ├── app.py
│   ├── Dockerfile
│   ├── GoFullPage.crx
│   ├── install_chrome.sh
│   ├── install_driver.sh
│   └── requirements.txt
├── samconfig.toml
└── template.yaml
</code></pre></div>

<h3 id="a-__init__py">a) __init__.py</h3>
<p>Both the <code>__init__.py</code> files should be empty</p>
<h3 id="b-eventseventjson">b) events/event.json</h3>
<p>We will use a basic event structure that will trigger our lambda. The contents should be</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;{\&quot;message\&quot;: \&quot;hello world\&quot;}&quot;</span><span class="p">,</span>
    <span class="nt">&quot;resource&quot;</span><span class="p">:</span> <span class="s2">&quot;/{proxy+}&quot;</span><span class="p">,</span>
    <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/path/to/resource&quot;</span><span class="p">,</span>
    <span class="nt">&quot;httpMethod&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="nt">&quot;isBase64Encoded&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;queryStringParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;pathParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;/path/to/resource&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;stageVariables&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;baz&quot;</span><span class="p">:</span> <span class="s2">&quot;qux&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Accept-Encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;gzip, deflate, sdch&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Accept-Language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US,en;q=0.8&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Cache-Control&quot;</span><span class="p">:</span> <span class="s2">&quot;max-age=0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Forwarded-Proto&quot;</span><span class="p">:</span> <span class="s2">&quot;https&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Is-Desktop-Viewer&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Is-Mobile-Viewer&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Is-SmartTV-Viewer&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Is-Tablet-Viewer&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
        <span class="nt">&quot;CloudFront-Viewer-Country&quot;</span><span class="p">:</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Host&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890.execute-api.us-east-1.amazonaws.com&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Upgrade-Insecure-Requests&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom User Agent String&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Via&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1 08f323deadbeefa7af34d5feb414ce27.cloudfront.net (CloudFront)&quot;</span><span class="p">,</span>
        <span class="nt">&quot;X-Amz-Cf-Id&quot;</span><span class="p">:</span> <span class="s2">&quot;cDehVQoZnx43VYQb9j2-nvCh-9z396Uhbp027Y2JvkCPNLmGJHqlaA==&quot;</span><span class="p">,</span>
        <span class="nt">&quot;X-Forwarded-For&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1, 127.0.0.2&quot;</span><span class="p">,</span>
        <span class="nt">&quot;X-Forwarded-Port&quot;</span><span class="p">:</span> <span class="s2">&quot;443&quot;</span><span class="p">,</span>
        <span class="nt">&quot;X-Forwarded-Proto&quot;</span><span class="p">:</span> <span class="s2">&quot;https&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;requestContext&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;accountId&quot;</span><span class="p">:</span> <span class="s2">&quot;123456789012&quot;</span><span class="p">,</span>
        <span class="nt">&quot;resourceId&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span><span class="p">,</span>
        <span class="nt">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;prod&quot;</span><span class="p">,</span>
        <span class="nt">&quot;requestId&quot;</span><span class="p">:</span> <span class="s2">&quot;c6af9ac6-7b61-11e6-9a41-93e8deadbeef&quot;</span><span class="p">,</span>
        <span class="nt">&quot;requestTime&quot;</span><span class="p">:</span> <span class="s2">&quot;09/Apr/2015:12:34:56 +0000&quot;</span><span class="p">,</span>
        <span class="nt">&quot;requestTimeEpoch&quot;</span><span class="p">:</span> <span class="mi">1428582896000</span><span class="p">,</span>
        <span class="nt">&quot;identity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;cognitoIdentityPoolId&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;accountId&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;cognitoIdentityId&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;caller&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;accessKey&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;sourceIp&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
            <span class="nt">&quot;cognitoAuthenticationType&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;cognitoAuthenticationProvider&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;userArn&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;userAgent&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom User Agent String&quot;</span><span class="p">,</span>
            <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="kc">null</span>
        <span class="p">},</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/prod/path/to/resource&quot;</span><span class="p">,</span>
        <span class="nt">&quot;resourcePath&quot;</span><span class="p">:</span> <span class="s2">&quot;/{proxy+}&quot;</span><span class="p">,</span>
        <span class="nt">&quot;httpMethod&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="nt">&quot;apiId&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890&quot;</span><span class="p">,</span>
        <span class="nt">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP/1.1&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="c-templateyaml">c) template.yaml</h3>
<div class="highlight"><pre><span></span><code><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span> <span class="s">&quot;2010-09-09&quot;</span>
<span class="nt">Transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS::Serverless-2016-10-31</span>
<span class="nt">Description</span><span class="p">:</span> <span class="p p-Indicator">&gt;</span>
  <span class="no">python3.8</span>
  <span class="no">Selenium on Lambda</span>
<span class="nt">Globals</span><span class="p">:</span>
  <span class="nt">Function</span><span class="p">:</span>
    <span class="nt">Timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">120</span>

<span class="nt">Resources</span><span class="p">:</span>
  <span class="nt">SeleniumFunction</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS::Serverless::Function</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">PackageType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Image</span>
      <span class="nt">Events</span><span class="p">:</span>
        <span class="nt">Selenium</span><span class="p">:</span>
          <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Api</span> 
          <span class="nt">Properties</span><span class="p">:</span>
            <span class="nt">Path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/twitter</span>
            <span class="nt">Method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get</span>
    <span class="nt">Metadata</span><span class="p">:</span>
      <span class="nt">Dockerfile</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Dockerfile</span>
      <span class="nt">DockerContext</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src</span>
      <span class="nt">DockerTag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python3.9-Selenium</span>

<span class="nt">Outputs</span><span class="p">:</span>
  <span class="nt">SeleniumApi</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="s">&quot;API</span><span class="nv"> </span><span class="s">Gateway</span><span class="nv"> </span><span class="s">endpoint</span><span class="nv"> </span><span class="s">URL</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">Prod</span><span class="nv"> </span><span class="s">stage</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">Selenium</span><span class="nv"> </span><span class="s">function&quot;</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="kt">!Sub</span> <span class="s">&quot;https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/selenium/&quot;</span>
  <span class="nt">SeleniumFunction</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="s">&quot;Selenium</span><span class="nv"> </span><span class="s">Lambda</span><span class="nv"> </span><span class="s">Function</span><span class="nv"> </span><span class="s">ARN&quot;</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="kt">!GetAtt</span> <span class="l l-Scalar l-Scalar-Plain">Selenium.Arn</span>
</code></pre></div>

<h3 id="d-srcdockerfile">d) src/Dockerfile</h3>
<p>Our Dockerfile needs to do the following</p>
<ol>
<li>Start from the python:buster image</li>
<li>Install AWS Lambda dependencies to run the Lambda function on custom image</li>
<li>Install Lambda Runtime Interface Client to implement Lambda Runtime API</li>
<li>Copy the extension, app.py and requirements.txt to the Docker image</li>
<li>Install the python dependencies</li>
<li>Install Chrome Browser to auto install Chromium dependencies</li>
<li>Install latest Chromium Browser</li>
<li>Install latest Chromedriver</li>
<li>Install Xvfb and dependencies</li>
<li>Configure Lambda Runtime API to execute the Lambda function</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c"># Define function directory</span>
<span class="k">ARG</span> <span class="nv">FUNCTION_DIR</span><span class="o">=</span><span class="s2">&quot;/function&quot;</span>
<span class="k">ARG</span> <span class="nv">RUNTIME_VERSION</span><span class="o">=</span><span class="s2">&quot;3.9&quot;</span>


<span class="k">FROM</span> <span class="s">ubuntu:latest</span> <span class="k">as</span> <span class="s">base-image</span>

<span class="k">RUN</span> apt-get update <span class="o">&amp;&amp;</span> <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive <span class="nv">TZ</span><span class="o">=</span>Etc/UTC
<span class="k">RUN</span> apt-get install -y g++ make cmake unzip libcurl4-openssl-dev
<span class="k">RUN</span> apt-get install -y python3 python3-pip 
<span class="k">RUN</span> apt-get install xvfb python3-tk python3-dev -y
<span class="k">RUN</span> apt-get install curl wget -y

<span class="k">ARG</span> FUNCTION_DIR
<span class="c"># Create function directory</span>
<span class="k">RUN</span> mkdir -p <span class="si">${</span><span class="nv">FUNCTION_DIR</span><span class="si">}</span>
<span class="c"># Copy function code</span>


<span class="k">RUN</span> pip install <span class="se">\</span>
    --target <span class="si">${</span><span class="nv">FUNCTION_DIR</span><span class="si">}</span> <span class="se">\</span>
    awslambdaric

<span class="c"># Include global arg in this stage of the build</span>
<span class="k">ARG</span> FUNCTION_DIR
<span class="c"># Set working directory to function root directory</span>
<span class="k">WORKDIR</span><span class="s"> ${FUNCTION_DIR}</span>

<span class="c"># Copy setup &amp; other temporary files</span>
<span class="k">COPY</span> requirements.txt /tmp/
<span class="c">#COPY GoFullPage.crx /opt/</span>
<span class="k">RUN</span> pip install --upgrade pip -q
<span class="k">RUN</span> pip install -r /tmp/requirements.txt -q
<span class="k">COPY</span> install_chrome.sh /tmp/
<span class="k">RUN</span> /bin/bash /tmp/install_chrome.sh
<span class="k">COPY</span> install_driver.sh /tmp/
<span class="k">RUN</span> /bin/bash /tmp/install_driver.sh
<span class="k">COPY</span> install_chromium.sh /tmp/
<span class="k">RUN</span> /bin/bash /tmp/install_chromium.sh
<span class="k">COPY</span> app.py <span class="si">${</span><span class="nv">FUNCTION_DIR</span><span class="si">}</span>

<span class="k">COPY</span> GoFullPage.crx /opt/
<span class="k">RUN</span> ls -al /opt/chrome/stable/

<span class="k">ENTRYPOINT</span> <span class="p">[</span> <span class="s2">&quot;python3&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;awslambdaric&quot;</span> <span class="p">]</span>
<span class="k">CMD</span> <span class="p">[</span> <span class="s2">&quot;app.handler&quot;</span> <span class="p">]</span>
</code></pre></div>

<h3 id="e-srcgofullpagecrx">e) src/GoFullPage.crx</h3>
<p><a href="https://chrome.google.com/webstore/detail/gofullpage-full-page-scre/fdpohaocaechififmbbbbbknoalclacl?hl=en">Go Full Page</a> is the chrome extension that we will use in this demo. </p>
<p>There are many ways to download Chrome extensions, in this case I recommend running the below command</p>
<div class="highlight"><pre><span></span><code>curl -L <span class="s2">&quot;https://clients2.google.com/service/update2/crx?response=redirect&amp;\</span>
<span class="s2">os=win&amp;arch=x64&amp;os_arch=x86_64&amp;nacl_arch=x86-64&amp;prod=chromiumcrx&amp;\</span>
<span class="s2">prodchannel=beta&amp;prodversion=79.0.3945.53&amp;lang=ru&amp;acceptformat=crx3\</span>
<span class="s2">&amp;x=id%3Dfdpohaocaechififmbbbbbknoalclacl%26installsource%3Dondemand%26uc&quot;</span> -o GoFullPage.crx
</code></pre></div>

<h3 id="f-srcinstall_chromesh">f) src/install_chrome.sh</h3>
<p>Next we install Chrome browser</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

apt-get update <span class="o">&amp;&amp;</span> apt-get upgrade -y

<span class="nb">echo</span> <span class="s2">&quot;Download the latest Chrome .deb file...&quot;</span>
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -q

<span class="nb">echo</span> <span class="s2">&quot;Install Google Chrome...&quot;</span>
dpkg -i google-chrome-stable_current_amd64.deb

<span class="nb">echo</span> <span class="s2">&quot;Fix dependencies...&quot;</span>
apt-get --fix-broken install -y
</code></pre></div>

<p>Make sure you make this file executable by running the following command</p>
<div class="highlight"><pre><span></span><code>chmod +x src/install_chrome.sh
</code></pre></div>

<h3 id="g-srcinstall_chromiumsh">g) src/install_chromium.sh</h3>
<p>Now with dependencies installed we can install Chromium browser</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">echo</span> <span class="s2">&quot;Downloading Chromium&quot;</span>
mkdir -p <span class="s2">&quot;/opt/chrome/stable&quot;</span>
curl -Lo <span class="s2">&quot;/opt/chrome/stable/chrome-linux.zip&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/\</span>
<span class="s2">    o/Linux_x64%2F954502%2Fchrome-linux.zip?generation=1640815524872726&amp;alt=media&quot;</span>
unzip -q <span class="s2">&quot;/opt/chrome/stable/chrome-linux.zip&quot;</span> -d <span class="s2">&quot;/opt/chrome/stable/&quot;</span>
ls -al /opt/chrome/stable/chrome-linux
mv /opt/chrome/stable/chrome-linux/* /opt/chrome/stable/
rm -rf /opt/chrome/stable/chrome-linux /opt/chrome/stable/chrome-linux.zip
</code></pre></div>

<p>Make this file executable by running </p>
<div class="highlight"><pre><span></span><code>chmod +x src/install_chromium.sh
</code></pre></div>

<h3 id="h-srcinstall_driversh">h) src/install_driver.sh</h3>
<p>Now we install a compatible chrome driver. The below script </p>
<ol>
<li>Gets the version of Chrome installed, </li>
<li>Then gets the latest version of the chromedriver available, </li>
<li>Compares if the versions are the same</li>
<li>Downloads the latest chromedriver if the version match</li>
<li>If not, it will exit with an error</li>
</ol>
<p>If you have used the <code>install_chrome.sh</code> script to install Chrome, the versions should match. </p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s2">&quot;Getting Chrome version...&quot;</span>
<span class="nv">chrome_version</span><span class="o">=(</span><span class="k">$(</span>google-chrome-stable --version<span class="k">)</span><span class="o">)</span>
<span class="nv">version</span><span class="o">=</span><span class="si">${</span><span class="nv">chrome_version</span><span class="p">[2]</span><span class="si">}</span>
<span class="nv">chrome_version</span><span class="o">=</span><span class="si">${</span><span class="nv">version</span><span class="p">%.*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;Chrome version: </span><span class="si">${</span><span class="nv">chrome_version</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nb">echo</span> <span class="s2">&quot;Getting latest chromedriver version&quot;</span>
<span class="nv">chromedriver_version_full</span><span class="o">=</span><span class="k">$(</span>curl <span class="s2">&quot;https://chromedriver.storage.googleapis.com/LATEST_RELEASE&quot;</span><span class="k">)</span>
<span class="nv">version</span><span class="o">=</span><span class="si">${</span><span class="nv">chromedriver_version_full</span><span class="si">}</span>
<span class="nv">chromedriver_version</span><span class="o">=</span><span class="si">${</span><span class="nv">version</span><span class="p">%.*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;Chromedriver version: </span><span class="si">${</span><span class="nv">chromedriver_version</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">chrome_version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="nv">$chromedriver_version</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Compatible Chromedriver is available...&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;Proceeding with installation...&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;Compabible Chromedriver not available...exiting&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&quot;Downloading latest Chromedriver...&quot;</span>
mkdir -p <span class="s2">&quot;/opt/chromedriver/stable/&quot;</span>

 curl <span class="s2">&quot;https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/\</span>
<span class="s2">      o/Linux_x64%2F954502%2Fchromedriver_linux64.zip?generation=1640815530134396&amp;alt=media&quot;</span> <span class="se">\</span>
  -H <span class="s1">&#39;authority: www.googleapis.com&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;96&quot;, &quot;Google Chrome&quot;;v=&quot;96&quot;&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-ch-ua-mobile: ?0&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-ch-ua-platform: &quot;Windows&quot;&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;dnt: 1&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;upgrade-insecure-requests: 1&#39;</span> <span class="se">\</span>
  -H <span class="s2">&quot;user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\</span>
<span class="s2">       Chrome/96.0.4664.110 Safari/537.36&quot;</span> <span class="se">\</span>
  -H <span class="s2">&quot;accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/\</span>
<span class="s2">      apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span> <span class="se">\</span>
  -H <span class="s2">&quot;x-client-data: CLO1yQEIhrbJAQiktskBCMG2yQEIqZ3KAQjRoMoBCMCXywEI6vLLAQie+csBCNf8ywEI5oTMAQi1\</span>
<span class="s2">      hcwBCMuJzAEI0IvMAQisjswBCJqPzAEI0o/MAQjakMwBCMmSzAEIoZPMAQjHk8wBCIqUzAEY5KDLAQ==&quot;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-fetch-site: none&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-fetch-mode: navigate&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-fetch-user: ?1&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;sec-fetch-dest: document&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;accept-language: en-GB,en-US;q=0.9,en;q=0.8,ms;q=0.7&#39;</span> <span class="se">\</span>
  --compressed &gt; /opt/chromedriver/stable/chromedriver_linux64.zip



unzip -q <span class="s2">&quot;/opt/chromedriver/stable/chromedriver_linux64.zip&quot;</span> <span class="se">\</span>
    -d <span class="s2">&quot;/opt/chromedriver/stable/&quot;</span>

mv /opt/chromedriver/stable/chromedriver_linux64/chromedriver /opt/chromedriver/stable/chromedriver

chmod +x <span class="s2">&quot;/opt/chromedriver/stable/chromedriver&quot;</span>
rm -rf <span class="s2">&quot;/opt/chromedriver/stable/chromedriver_linux64.zip&quot;</span>

<span class="nb">echo</span> <span class="s2">&quot;Chrome &amp; Chromedriver installed&quot;</span>
</code></pre></div>

<p>Again, make sure you make this file executable by running the following command</p>
<div class="highlight"><pre><span></span><code>chmod +x src/install_driver.sh
</code></pre></div>

<h3 id="i-srcapppy">i) src/app.py</h3>
<p>The app.py file needs model the following user behavior 
1. Open the browser with the extension installed
2. Open <code>www.example.com</code>
3. Close extension welcome page
4. Start screenshot capture by pressing <code>Shift + Alt + P</code>
5. Navigate to the screenshot page
6. Download the screenshot to the default downloads directory by clicking on download button
7. Close the browser
8. Upload the screenshot(s) to S3</p>
<p><img alt="user-behaviour" src="http://localhost:8080/images/99999962-user-behaviour.gif"></p>
<p>We achive this by the following code. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/app.py</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">from</span> <span class="nn">pyvirtualdisplay</span> <span class="kn">import</span> <span class="n">Display</span>
<span class="c1">#from pyvirtualdisplay.smartdisplay import SmartDisplay</span>



<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">display</span> <span class="o">=</span> <span class="n">Display</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:25&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2560</span><span class="p">,</span> <span class="mi">1440</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;xvfb&quot;</span><span class="p">)</span> 
    <span class="n">display</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Started Display&#39;</span><span class="p">)</span>
    <span class="c1">#Pyautogui requires os.environ[&quot;Display&quot;] variable to be set. </span>
    <span class="kn">import</span> <span class="nn">pyautogui</span>

    <span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
    <span class="c1"># Headless environment starts without browser UI so no extensions</span>
    <span class="c1">#chrome_options.add_argument(&quot;--headless&quot;) </span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">binary_location</span> <span class="o">=</span> <span class="s2">&quot;/opt/chrome/stable/chrome&quot;</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--no-sandbox&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-dev-shm-usage&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-gpu&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-dev-tools&quot;</span><span class="p">)</span>
    <span class="c1">#chrome_options.add_argument(&quot;--no-zygote&quot;) #This will not load the extension</span>
    <span class="c1">#chrome_options.add_argument(&quot;--single-process&quot;) #Single process will break the app</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;window-size=2560x1440&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--remote-debugging-port=9222&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--user-data-dir=/tmp/chrome-user-data&quot;</span><span class="p">)</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_extension</span><span class="p">(</span><span class="s2">&quot;/opt/GoFullPage.crx&quot;</span><span class="p">)</span>
    <span class="n">download_directory</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;download.default_directory&quot;</span><span class="p">:</span> <span class="s2">&quot;/tmp/&quot;</span><span class="p">}</span>
    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;prefs&quot;</span><span class="p">,</span> <span class="n">download_directory</span><span class="p">)</span>
    <span class="n">webdriver_service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span><span class="s2">&quot;/opt/chromedriver/stable/chromedriver&quot;</span><span class="p">)</span>
    <span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">webdriver_service</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>

    <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
    <span class="c1"># Open Extension options</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Open Extension options...&quot;</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chrome-extension://fdpohaocaechififmbbbbbknoalclacl/options.html&quot;</span><span class="p">)</span>

    <span class="c1"># Provide Download Permission</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Provide Download Permission...&quot;</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&quot;perm-toggle&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">NAME</span><span class="p">,</span> <span class="s2">&quot;downloads&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">active_element</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pyautogui</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s2">&quot;tab&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pyautogui</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s2">&quot;enter&quot;</span><span class="p">)</span>

    <span class="c1"># Close options</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Close options...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">))</span> <span class="c1">#Expected 2</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">))</span> <span class="c1">#Expected 1</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Take screenshot</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Take screenshot...&quot;</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pyautogui</span><span class="o">.</span><span class="n">hotkey</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">,</span> <span class="s2">&quot;alt&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">))</span> <span class="c1">#Expected 2</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&quot;btn-download&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>


    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

    <span class="c1"># importing earlier conflicts with selenium actions</span>
    <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
    <span class="n">BUCKET_NAME</span> <span class="o">=</span> <span class="s2">&quot;cloudbytes.dev&quot;</span> <span class="c1"># replace with your bucket name</span>

    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s2">&quot;/tmp/*.png&quot;</span><span class="p">):</span> 
        <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">BUCKET_NAME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;success&quot;</span><span class="p">}</span>
</code></pre></div>

<p>Make sure you replace the <code>BUCKET_NAME</code> in the code with your bucket name. </p>
<h3 id="j-srcrequirementstxt">j) src/requirements.txt</h3>
<p>This will contain the python dependencies required for the Lambda function</p>
<div class="highlight"><pre><span></span><code>selenium
pyvirtualdisplay
pillow
keyboard
pyautogui
python-xlib
boto3
</code></pre></div>

<h2 id="build-test-lambda-app-to-run-chrome-with-extension">Build &amp; test Lambda app to run Chrome with extension</h2>
<p>To build, just run the following command</p>
<div class="highlight"><pre><span></span><code>sam build
</code></pre></div>

<p>This will result in a message similar to this (the build process typically takes a few minutes given your internet speed)</p>
<p><img alt="sam-build-output" src="http://localhost:8080/images/99999962-sam-build-output.png"></p>
<p>Finally, to test the Lambda function, run the following command</p>
<div class="highlight"><pre><span></span><code>sam local invoke
</code></pre></div>

<p>This will run the Lambda function locally and display the following output</p>
<p><img alt="sam-invoke-output" src="http://localhost:8080/images/99999962-sam-invoke-output.png"></p>
<h3 id="check-the-results">Check the results</h3>
<p>Go to your AWS console and navigate to the S3 bucket that you chose in the step (i) above.</p>
<p>You should see the screenshot(s) that you uploaded to S3 for each test execution. </p>
<p><img alt="aws-s3-screenshots" src="http://localhost:8080/images/99999962-aws-s3-screenshots.png"></p>
<h2 id="deploying-to-aws-lambda">Deploying to AWS Lambda</h2>
<p>Deploying to AWS Lambda is as simple as running the below</p>
<div class="highlight"><pre><span></span><code>sam deploy --guided
</code></pre></div>

<p>This will launch a guided deployment process, you can use the following:</p>
<div class="highlight"><pre><span></span><code>Configuring SAM deploy
======================

        Looking for config file [samconfig.toml] :  Found
        Reading default arguments  :  Success

        Setting default arguments for &#39;sam deploy&#39;
        =========================================
        Stack Name [selaws]: 
        AWS Region [us-east-1]: 
        #Shows you resources changes to be deployed and require a &#39;Y&#39; to initiate deploy
        Confirm changes before deploy [y/N]: 
        #SAM needs permission to be able to create roles to connect to the resources in your template
        Allow SAM CLI IAM role creation [Y/n]: 
        #Preserves the state of previously provisioned resources when an operation fails
        Disable rollback [y/N]: 
        SeleniumFunction may not have authorization defined, Is this okay? [y/N]: y
        Save arguments to configuration file [Y/n]: 
        SAM configuration file [samconfig.toml]: 
        SAM configuration environment [default]: 
</code></pre></div>

<p>Now you can run the Lambda app from the AWS console. Alternatively, you can also run the Lambda function by calling the API we created by using the following command</p>
<div class="highlight"><pre><span></span><code>curl https://&lt;api-id&gt;.execute-api.us-east-1.amazonaws.com/Prod/selenium/
</code></pre></div>

<p>You can get the API ID from deployment output of <code>sam deploy</code> as shown below:</p>
<p><img alt="lambda-api-url" src="http://localhost:8080/images/99999962-lambda-api-url.png"></p>
<h2 id="final-code">Final Code</h2>
<p>The above code is available on <a href="https://github.com/rehanhaider/selenium-aws-chrome-extension">GitHub in this repository</a>. </p>
            </article>
            <h5>Need Help? <a href="https://github.com/CloudBytesDotDev/CloudBytes.dev/discussions">Open a discussion
                    thread on GitHub</a>.</h5>
<div class="article-tags">
    <a href="/tags/python"><span class="tag tag-python">#python</span></a>
    <a href="/tags/aws"><span class="tag tag-aws">#aws</span></a>
    <a href="/tags/selenium"><span class="tag tag-selenium">#selenium</span></a>
</div>            <hr>
<div>
    <h3 style="margin: 10px 0;">Related Posts</h3>
</div>
<div class="chapters-list">
    <div class="chapters-wrap">
        <a href="/snippets/run-selenium-in-aws-lambda-for-ui-testing">
            <div class="box box-sm chapter-item">
                <i class="box-icon">
                    <div>
                        <i class="emoji">📄</i>
                    </div>
                </i>
                <div class="box-content">
                    <span class="subtext">Run Selenium in AWS Lambda for UI testing</span>
                </div>
            </div>
        </a>
        <a href="/snippets/mount-aws-credentials-on-vscode-devcontainers">
            <div class="box box-sm chapter-item">
                <i class="box-icon">
                    <div>
                        <i class="emoji">📄</i>
                    </div>
                </i>
                <div class="box-content">
                    <span class="subtext">Mount AWS Credentials on VSCode Devcontainers</span>
                </div>
            </div>
        </a>
        <a href="/snippets/run-selenium-in-jupyter-notebook-on-wsl2-or-ubuntu">
            <div class="box box-sm chapter-item">
                <i class="box-icon">
                    <div>
                        <i class="emoji">📄</i>
                    </div>
                </i>
                <div class="box-content">
                    <span class="subtext">Run selenium in Jupyter Notebook on WSL2 or Ubuntu</span>
                </div>
            </div>
        </a>
        <a href="/snippets/run-selenium-and-chrome-on-wsl2">
            <div class="box box-sm chapter-item">
                <i class="box-icon">
                    <div>
                        <i class="emoji">📄</i>
                    </div>
                </i>
                <div class="box-content">
                    <span class="subtext">Run Selenium and Chrome on WSL2 using Python and Selenium webdriver</span>
                </div>
            </div>
        </a>
        <a href="/snippets/configure-logging-in-aws-lambda-to-cloudwatch-using-python">
            <div class="box box-sm chapter-item">
                <i class="box-icon">
                    <div>
                        <i class="emoji">📄</i>
                    </div>
                </i>
                <div class="box-content">
                    <span class="subtext">Configure logging in AWS Lambda to CloudWatch using Python</span>
                </div>
            </div>
        </a>
    </div>
</div>
        </section>
    </div>

</article>
        <aside class="sidebar">
<div class="recourse" style="text-align:center">
    <div class="box chapter-item">
        <div class="box-content">
            <a href="https://click.linksynergy.com/link?id=zOWbNCBDzko&offerid=1060092.822444&type=2&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fpython-and-django-full-stack-web-developer-bootcamp%2F" rel="nofollow" style="text-decoration:none">
                <div>
                    <h3 style="border-bottom: 2px white;">📽️ Curated Tutorial</h3>
                    <hr style="border-color:var(--text-color)">
                    <hr style="border-color:var(--text-color)">
                </div>
                <div class=" banner">
                    <IMG border=0 src="https://img-b.udemycdn.com/course/480x270/822444_a6db.jpg?secure=K6tKj_8lsi_hfHPsKXup8A%3D%3D%2C1647332006">
                    <h4>
                        Python and Django Full Stack Web Developer Bootcamp
                    </h4>
                    <p style="font-size:.75em">
                        Learn to build websites with HTML, CSS, Bootstrap, Javascript, jQuery, Python 3, and Django!!
                    </p>
                    <h4>
                        <u>Click Here for more info!</u>
                    </h4>
                </div>
            </a>
            <IMG border=0 width=1 height=1 src="https://ad.linksynergy.com/fs-bin/show?id=zOWbNCBDzko&bids=1060092.822444&type=2&subid=0">
        </div>
    </div>
</div>
        </aside>
    </main>
    <!-- End of Main Section -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!-- Footer -->

    <footer>
<div class="footer-row">
    <h3>Want to improve this guide? Submit your changes on <a
            href="https://github.com/CloudBytesDotDev/CloudBytes.dev/tree/main/content/articles/99999962-run-chrome-extensions-python-selenium.md">GitHub.</a>
    </h3>
    <p class="copyright">Copyright &copy; 2020 - 2022 CloudBytes. All rights reserved.</p>
    <ul>
        <li class="footer-nav"><a href="/terms">Terms</a></li>
        <li class="footer-nav"><a href="/privacy">Privacy Policy</a></li>
        <li class="footer-nav"><a href="/sitemap.xml">Sitemap</a></li>
    </ul>
</div>    </footer>
</body>
<!-- Include AlgoliaSearch JS Client and autocomplete.js library -->
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<!-- Initialize autocomplete menu -->
<script>
    var client = algoliasearch("XE8PCLJHAE", "ec75de1d8ce87dee234a2fd47cec2d76");
    var index = client.initIndex('cloudbytes_dev');
    //initialize autocomplete on search input (ID selector must match)
    autocomplete('#algolia-input',
        { hint: false }, {
        source: autocomplete.sources.hits(index, { hitsPerPage: 10 }),
        //value to be displayed in input control after user's suggestion selection
        displayKey: 'title',
        //hash of templates used when rendering dataset
        templates: {
            //'suggestion' templating function used to render a single suggestion
            suggestion: function (suggestion) {
                return '<a class="algolia-hit" href="/' + suggestion.url + '">' +
                    '<h4>' +
                    '<span class="hit-title">' + suggestion._highlightResult.title.value + '</span>' +
                    '</h4>' +
                    '</a>'
            }
        }
    });
</script>

</html>